<!doctype html>
<html>
  <head>
    <title>Admin Login | WellNest Hospital</title>

    <!-- Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- Icons -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
      rel="stylesheet"
    />

    <style>
      body {
        background: linear-gradient(135deg, #e8f4ff, #f9fcff);
        font-family: "Segoe UI", sans-serif;
      }

      .login-card {
        width: 380px;
        border-radius: 18px;
        border: none;
      }

      .brand {
        font-size: 22px;
        font-weight: 700;
        color: #0d6efd;
      }

      .subtext {
        font-size: 13px;
        color: #6c757d;
      }

      .form-control {
        border-radius: 10px;
        padding: 12px;
      }

      .btn-login {
        border-radius: 10px;
        padding: 12px;
        font-weight: 600;
      }

      .hospital-icon {
        width: 60px;
        height: 60px;
        background: #e7f1ff;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 30px;
        color: #0d6efd;
        margin: 0 auto;
      }
    </style>
  </head>

  <body class="d-flex align-items-center justify-content-center vh-100">
    <div class="card shadow login-card p-4">
      <!-- ICON -->
      <div style="display: flex; width: 100%; justify-content: center">
        <img
          src="{{ request.url_for('media', path='logos/wecare_header.png') }}"
          style="width: 200px"
        />
      </div>
      <!-- TITLE -->
      <div class="text-center mb-4">
        <!-- <div class="brand">WellNest Hospital</div> -->
        <div class="subtext">Admin Panel Login</div>
      </div>

      <!-- PHONE -->
      <div class="mb-3">
        <label class="form-label text-muted">Phone Number</label>
        <input
          id="phone"
          class="form-control"
          placeholder="Enter phone number"
        />
      </div>

      <!-- PASSWORD -->
      <div class="mb-4">
        <label class="form-label text-muted">Password</label>
        <input
          id="password"
          type="password"
          class="form-control"
          placeholder="Enter password"
        />
      </div>

      <!-- LOGIN BUTTON -->
      <button class="btn btn-primary w-100 btn-login" onclick="login()">
        <i class="bi bi-box-arrow-in-right me-1"></i>
        Login
      </button>

      <!-- FOOTER -->
      <a
        target="_blank"
        href="https://digitalwishmedia.com/"
        class="text-center mt-4 subtext"
      >
        Â© Made by Digital Wish Media (DWM)
      </a>
    </div>

    <!-- ðŸ”¥ JS UNCHANGED -->
    <script>
      async function login() {
        const r = await fetch("/auth/login-password", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            phone: phone.value,
            password: password.value,
          }),
        });

        const d = await r.json();
        console.log("D", d);

        // if (d.access_token) {
        //   localStorage.setItem("token", d.access_token);
        //   window.location.href = "/admin/dashboard";
        // }

        if (d.access_token) {
          localStorage.setItem("token", d.access_token);

          // ðŸ”¥ ROLE BASED REDIRECT
          if (d.role === "ADMIN") {
            window.location.href = "/admin/dashboard";
          } else if (d.role === "NURSE") {
            window.location.href = "/admin/nurses";
          } else if (d.role === "DOCTOR") {
            window.location.href = "/admin/doctors";
          } else if (d.role === "PATIENT") {
            window.location.href = "/admin/patients";
          } else {
            alert("Unknown role");
          }
        } else {
          alert("Login failed");
        }
      }
    </script>
  </body>
</html>
