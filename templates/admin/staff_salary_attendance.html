{% extends "admin/base.html" %} {% block title %}Staff Attendance & Salary{%
endblock %} {% block content %}

<h4 class="mb-3">ðŸ“Š Staff Attendance & Salary</h4>

<!-- ================= STAFF INFO ================= -->
<div class="card shadow-sm mb-4">
  <div class="card-body row">
    <div class="col-md-4">
      <p><b>Name:</b> {{ staff.user.name }}</p>
      <p><b>Role:</b> {{ staff_role }}</p>
      <p><b>Phone:</b> {{ staff.user.phone }}</p>
    </div>

    <div class="col-md-4">
      <p><b>Joining Date:</b> {{ staff.joining_date or "-" }}</p>
      <p>
        <b>Status:</b>
        {% if staff.user.is_active %}
        <span class="badge bg-success">Active</span>
        {% else %}
        <span class="badge bg-danger">Inactive</span>
        {% endif %}
      </p>
    </div>

    <div class="col-md-4">
      <p><b>Salary Type:</b> {{ consent.salary_type }}</p>
      <p><b>Salary Amount:</b> â‚¹{{ consent.salary_amount }}</p>
    </div>
  </div>
</div>

<!-- ================= MONTH SELECT ================= -->
<div class="card shadow-sm mb-4">
  <div class="card-body row align-items-end">
    <div class="col-md-3">
      <label class="form-label">Select Month</label>
      <input type="month" id="month" class="form-control" value="{{ month }}" />
    </div>

    <div class="col-md-2">
      <button class="btn btn-primary w-100" id="loadBtn">Load Report</button>
    </div>
  </div>
</div>

<!-- ================= ATTENDANCE SUMMARY ================= -->
<div class="row mb-4">
  <div class="col-md-3">
    <div class="card text-center shadow-sm">
      <div class="card-body">
        <h6>Total Days</h6>
        <h4>{{ summary.total_days }}</h4>
      </div>
    </div>
  </div>

  <div class="col-md-3">
    <div class="card text-center shadow-sm">
      <div class="card-body">
        <h6>Present</h6>
        <h4 class="text-success">{{ summary.present_days }}</h4>
      </div>
    </div>
  </div>

  <div class="col-md-3">
    <div class="card text-center shadow-sm">
      <div class="card-body">
        <h6>Absent</h6>
        <h4 class="text-danger">{{ summary.absent_days }}</h4>
      </div>
    </div>
  </div>

  <div class="col-md-3">
    <div class="card text-center shadow-sm">
      <div class="card-body">
        <h6>Total Hours</h6>
        <h4>{{ summary.total_hours }}</h4>
      </div>
    </div>
  </div>
</div>

<!-- ================= DAILY ATTENDANCE TABLE ================= -->
<div class="card shadow-sm mb-4">
  <div class="card-header bg-light"><b>ðŸ“… Daily Attendance</b></div>
  <div class="card-body table-responsive">
    <table class="table table-bordered table-sm align-middle">
      <thead class="table-light">
        <tr>
          <th>Date</th>
          <th>Check In</th>
          <th>Check Out</th>
          <th>Hours</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        {% for a in attendance %}
        <tr>
          <td>{{ a.date }}</td>
          <td>{{ a.check_in or "-" }}</td>
          <td>{{ a.check_out or "-" }}</td>
          <td>{{ a.hours or "-" }}</td>
          <td>
            {% if a.check_in %}
            <span class="badge bg-success">Present</span>
            {% else %}
            <span class="badge bg-danger">Absent</span>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<!-- ================= SALARY CALCULATION ================= -->
<div class="card shadow-sm mb-4">
  <div class="card-header bg-light"><b>ðŸ’° Salary Calculation</b></div>
  <div class="card-body row">
    <div class="col-md-3">
      <p><b>Basic Salary:</b></p>
      <h5>â‚¹{{ salary.basic }}</h5>
    </div>

    <div class="col-md-3">
      <p><b>Deductions:</b></p>
      <h5 class="text-danger">â‚¹{{ salary.deductions }}</h5>
    </div>

    <div class="col-md-3">
      <p><b>Advance:</b></p>
      <h5 class="text-warning">â‚¹{{ salary.advance }}</h5>
    </div>

    <div class="col-md-3">
      <p><b>Net Salary:</b></p>
      <h4 class="text-success">â‚¹{{ salary.net }}</h4>
    </div>
  </div>
</div>

<!-- ================= ACTIONS ================= -->
<div class="d-flex gap-2 mb-4">
  <button class="btn btn-primary">ðŸ“„ Generate Payslip</button>

  {% if salary.payslip_pdf %}
  <a
    href="{{ salary.payslip_pdf }}"
    class="btn btn-outline-secondary"
    target="_blank"
  >
    â¬‡ Download Payslip
  </a>
  {% endif %} {% if not salary.is_paid %}
  <button class="btn btn-success">âœ… Mark as Paid</button>
  {% else %}
  <span class="badge bg-success align-self-center">Paid</span>
  {% endif %}
</div>

{% endblock %}
